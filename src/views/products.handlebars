<h1>Productos</h1>

<form id="filterForm" action="/products" method="get" style="margin-bottom:20px;">
  <input type="text" name="query" placeholder="Categoría" value="{{queryParams.query}}">
  <select name="sort">
    <option value="">Orden</option>
    <option value="asc" {{#ifEquals queryParams.sort "asc"}}selected{{/ifEquals}}>Precio asc</option>
    <option value="desc" {{#ifEquals queryParams.sort "desc"}}selected{{/ifEquals}}>Precio desc</option>
  </select>
  <input type="number" name="limit" min="1" value="{{queryParams.limit}}">
  <button type="submit">Filtrar</button>
</form>

<div class="productsList">
  <ul id="productsGrid">
    {{#each products}}
      <li data-id="{{_id}}">
        <img src="{{thumbnails.[0]}}" alt="{{title}}">
        <h3>{{title}}</h3>
        <p>{{description}}</p>
        <p>Precio: ${{price}}</p>
        <p>Categoría: {{category}}</p>
        <div style="display:flex;gap:.5rem;">
          <a href="/products/{{_id}}">Ver</a>
          <button class="addToCartBtn" data-pid="{{_id}}">Agregar al carrito</button>
        </div>
      </li>
    {{/each}}
  </ul>
</div>

<div class="pagination" style="margin-top:20px;">
  {{#if hasPrevPage}}
    <a href="{{prevLink}}">« Anterior</a>
  {{/if}}
  <span> Página {{page}} de {{totalPages}} </span>
  {{#if hasNextPage}}
    <a href="{{nextLink}}">Siguiente »</a>
  {{/if}}
</div>

<script src="/js/products.js"></script>
